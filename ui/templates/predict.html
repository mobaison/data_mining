{% extends "base.html" %}

{% block title %}Predict - Heart Disease Prediction{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800">Heart Disease Risk Assessment</h1>
        <p class="text-gray-600 mt-2">Enter patient information for prediction</p>
    </div>

    <form id="prediction-form" method="POST" action="{{ url_for('predict') }}" class="space-y-6">
        <!-- Patient Information Card -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex items-center mb-6">
                <div class="bg-blue-100 p-2 rounded-lg mr-3">
                    <i class="fas fa-user-circle text-blue-600 text-xl"></i>
                </div>
                <h2 class="text-xl font-bold text-gray-800">Patient Information</h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">
                        <i class="fas fa-user mr-2"></i>Patient Name *
                    </label>
                    <input type="text" name="patient_name" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                           placeholder="Enter patient's full name">
                </div>
                
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">
                        <i class="fas fa-birthday-cake mr-2"></i>Age *
                    </label>
                    <input type="number" name="age" required min="0" max="100"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                           placeholder="">
                    <p class="text-sm text-gray-500 mt-1">Enter age in years </p>
                </div>
                
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">
                        <i class="fas fa-venus-mars mr-2"></i>Sex *
                    </label>
                    <div class="grid grid-cols-2 gap-4">
                        <label class="flex items-center p-4 border rounded-lg cursor-pointer hover:bg-blue-50 transition">
                            <input type="radio" name="sex" value="Male" required class="mr-3">
                            <div class="flex items-center">
                                <i class="fas fa-mars text-blue-600 mr-2"></i>
                                <span>Male</span>
                            </div>
                        </label>
                        <label class="flex items-center p-4 border rounded-lg cursor-pointer hover:bg-pink-50 transition">
                            <input type="radio" name="sex" value="Female" required class="mr-3">
                            <div class="flex items-center">
                                <i class="fas fa-venus text-pink-600 mr-2"></i>
                                <span>Female</span>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Clinical Parameters Card -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <div class="flex items-center mb-6">
                <div class="bg-red-100 p-2 rounded-lg mr-3">
                    <i class="fas fa-heartbeat text-red-600 text-xl"></i>
                </div>
                <h2 class="text-xl font-bold text-gray-800">Clinical Parameters</h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Chest Pain Type -->
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">
                        <i class="fas fa-notes-medical mr-2"></i>Chest Pain Type *
                    </label>
                    <select name="chest_pain_type" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        <option value="">Select type</option>
                        <option value="Typical Angina">Typical Angina</option>
                        <option value="Atypical Angina">Atypical Angina</option>
                        <option value="Non-anginal Pain">Non-anginal Pain</option>
                        <option value="Asymptomatic">Asymptomatic</option>
                    </select>
                </div>
                
                <!-- Cholesterol -->
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">
                        <i class="fas fa-tint mr-2"></i>Cholesterol (mg/dl) *
                    </label>
                    <input type="number" name="cholesterol" required min="126" max="564"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                           placeholder="126 - 564 mg/dl">
                </div>
                
                <!-- Fasting Blood Sugar -->
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">
                        <i class="fas fa-syringe mr-2"></i>Fasting Blood Sugar *
                    </label>
                    <select name="fasting_bs" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        <option value="">Select level</option>
                        <option value="≤120 mg/dl">≤120 mg/dl (Normal)</option>
                        <option value=">120 mg/dl">>120 mg/dl (High)</option>
                    </select>
                </div>
                
                <!-- Maximum Heart Rate -->
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">
                        <i class="fas fa-heart mr-2"></i>Max Heart Rate *
                    </label>
                    <input type="number" name="max_hr" required min="71" max="202"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                           placeholder="71 - 202 bpm">
                </div>
                
                <!-- Exercise Induced Angina -->
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">
                        <i class="fas fa-running mr-2"></i>Exercise Angina *
                    </label>
                    <select name="exercise_angina" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        <option value="">Select</option>
                        <option value="No">No</option>
                        <option value="Yes">Yes</option>
                    </select>
                </div>
                
                <!-- ST Depression (Oldpeak) -->
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">
                        <i class="fas fa-chart-line mr-2"></i>ST Depression *
                    </label>
                    <input type="number" name="oldpeak" required min="0" max="6.2" step="0.1"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
                           placeholder="0.0 - 6.2">
                    <p class="text-sm text-gray-500 mt-1">Depression induced by exercise</p>
                </div>
                
                <!-- ST Slope -->
                <div class="md:col-span-2 lg:col-span-1">
                    <label class="block text-gray-700 mb-2 font-medium">
                        <i class="fas fa-mountain mr-2"></i>ST Slope *
                    </label>
                    <select name="st_slope" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                        <option value="">Select slope</option>
                        <option value="Upsloping">Upsloping</option>
                        <option value="Flat">Flat</option>
                        <option value="Downsloping">Downsloping</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <button type="submit"
                    class="flex items-center justify-center bg-gradient-to-r from-green-600 to-blue-600 text-white px-8 py-4 rounded-lg font-bold text-lg hover:opacity-90 transition shadow-lg">
                <i class="fas fa-calculator mr-3"></i>
                Predict Heart Disease Risk
            </button>
            
            <button type="button" onclick="resetForm()"
                    class="flex items-center justify-center bg-gray-600 text-white px-8 py-4 rounded-lg font-bold text-lg hover:bg-gray-700 transition">
                <i class="fas fa-redo mr-3"></i>
                Reset Form
            </button>
        </div>
    </form>

    <!-- Form Instructions -->
    <div class="mt-8 bg-yellow-50 border-l-4 border-yellow-400 p-6 rounded-lg">
        <div class="flex items-start">
            <i class="fas fa-info-circle text-yellow-600 text-xl mt-1 mr-3"></i>
            <div>
                <h3 class="font-bold text-gray-800 mb-2">Important Notes:</h3>
                <ul class="list-disc pl-5 space-y-1 text-gray-600">
                    <li>All fields marked with * are required</li>
                    <li>Input ranges are based on UCI Heart Disease Dataset statistics</li>
                    <li>Cholesterol levels above 240 mg/dl are considered high risk</li>
                    <li>Asymptomatic chest pain can indicate silent ischemia</li>
                    <li>ST depression > 2.0 suggests potential myocardial ischemia</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function resetForm() {
    if (confirm('Are you sure you want to reset all fields?')) {
        document.getElementById('prediction-form').reset();
    }
}

// Form validation
document.getElementById('prediction-form').addEventListener('submit', function(e) {
    let isValid = true;
    const inputs = this.querySelectorAll('input[required], select[required]');
    
    inputs.forEach(input => {
        if (!input.value.trim()) {
            isValid = false;
            input.classList.add('border-red-500');
        } else {
            input.classList.remove('border-red-500');
        }
    });
    
    if (!isValid) {
        e.preventDefault();
        alert('Please fill in all required fields.');
    }
});

// Mobile menu toggle
document.getElementById('mobile-menu-button').addEventListener('click', function() {
    const menu = document.getElementById('mobile-menu');
    menu.classList.toggle('hidden');
});
</script>
{% endblock %}